# TIL (2023.05.24)

## DAY 7

오늘 읽은 범위: 시작 - 2장) 타입스크립트의 타입 시스템 - 아이템15 ~ 아이템 18

---

```
😉 책에서 기억하고 싶은 내용을 써보세요.
```

### 아이템 15 동적 데이터에 인덱스 시그니처 사용하기

- [property: string]: string이 인덱스 시그니처이며, 다음 세 가지 의미를 담고 있습니다.(p.85)
  - 키의 이름: 키의 위치만 표시하는 용도입니다. 타입 체커에서는 사용하지 않습니다.
  - 키의 타입: string이나 number 또는 symbol의 조합이어야 하지만, 보통은 string을 사용합니다.
  - 값의 타입: 어떤 것이든 될 수 있습니다.
- 어떤 타입에 가능한 필드가 제한되어 있는 경우라면 인덱스 시그니처로 모델링하지 말아야 합니다.(p.88)
  - 대안1: 인터페이스
  - 대안2: Record 사용
  - 대안3: 매핑된 타입을 사용하는 방법

### 아이템 16 number 인덱스 시그니처보다는 Array, 튜플, ArrayLike를 사용하기

- 타입스크립트는 이러한 혼란을 바로잡기 위해 숫자 키를 허용하고, 문자열 키와 다른 것으로 인식합니다. (p.91)
- 인덱스에 신경 쓰지 않는다면 : for-of
  인덱스의 타입이 중요하다면: forEach
  루프 중간에 멈춰야 한다면: for(;;)
  타입이 불확실하다면: for-in
  for-in루프는 for-of,for 루프에 비해 몇 배나 느립니다.
- 인덱스 시그니처에 number를 사용하기 보다 Array나 튜플, ArrayLike타입을 사용하는 것이 좋습니다.(p93)

### 아이템 17 변경 관련된 오류 방지를 위해 readonly 사용하기

- readonly number[]는 `타입`이고, number[] 와 구분되는 몇 가지 특징이 있습니다.
  - 배열의 요소를 읽을 수 있지만, 쓸 수는 없습니다.
  - length를 읽을 수 있지만, 바꿀 수는 없습니다.
  - 배열을 변경하는 pop을 비롯한 다른 메서드를 호출할 수 없습니다.
- 매개변수를 readonly로 선언하면 다음과 같은 일이 생깁니다.
  - 타입스크립트는 매개변수가 함수 내에서 변경이 일어나는지 체크합니다.
  - 호출하는 쪽에서는 함수가 매개변수를 변경하지 않는다는 보장을 받게 됩니다.
  - 호출하는 쪽에서 함수에 readonly 배열을 매개변수로 넣을 수도 있습니다.
- 자바스크립트에서는 명시적으로 언급하지 않는 한, 함수가 매개변수를 변경하지 않는다고 가정합니다.(p.95)
- readonly를 사용하면 지역변수와 관련된 모든 종류의 변경 오류를 방지할 수 있습니다.(p.96)

### 아이템 18 매핑된 타입을 사용하여 값을 동기화하기

- 실패에 닫힌 접근법: 오류 발생 시에 적극적으로 대처하는 방향을 말합니다. -> 보안
  실패에 열린 접근법: 오류 발생 시에 소극적으로 대처하는 방향입니다. -> 기능에 무리가 없고 사용성이 중요한 곳
- 타입 체커가 대신할 수 있게 하는 것이 좋습니다. (p.104)

  ```
    const REQUIRES_UPDATE: {[k in keyof ScatterProps]: boolean} = {
      xs: true,
      ys: true,
      xRange: true,
      yRange: true,
      color: true,
      onClick: false,
    }

    function shouldUpdate (
      oldProps: ScatterProps,
      newProps: ScatterProps
    ) {
      let k: keyof ScatterProps;
      for (k in oldProps) {
        if (oldProps[k] !== newProps[k] && REQUIRES_UPDATE[k]) {
          return true;
        }
      }
      return false;
    }
  ```

- 속성을 삭제하거나 이름을 바꾸어도 비숫한 오류가 발생합니다. (p.105)
- 매핑된 타입은 한 객체가 또 다른 객체와 정확히 같은 속성을 가지게 할 때 이상적입니다. 이번 예제처럼 매핑된 타입을
  사용해 타입스크립트 코드에 제약을 강제하도록 할 수 있습니다. (p.105)

```
🤔 오늘 익은 소감은? 떠오르는 생각을 가볍게 적어보세요
```

- 다양한 for에 대해서 언제 어떻게 써야 하는지 배웠다.
- 매핑된 타입을 이용하여 값을 동기화 하는 방법은 새롭게 보았던 방식이여서 신선했다.
- 2장 마지막까지 읽으면서 배웠던 것을 생각보다 다양하게 사용해 볼 수 있을 것 같다.

```
궁금한 내용이 있거나, 잘 이해되지 않는 내용이 있다면 적어보세요.
```

- 히포크라테스 전집 : 우선, 망치지 말 것(first, do no harm)
- ArrayLike
